<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>ğŸ’ Booking Eyelash List</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root{
    --primary:#7b2cbf;
    --success:#25D366;
    --danger:#dc3545;
    --warning:#ffc107;
    --dark:#343a40;
    --soft:#f8f9ff;
}
*{box-sizing:border-box}
body{
    font-family:'Segoe UI',sans-serif;
    background:linear-gradient(135deg,#f8f0ff,#eef2ff);
    margin:0;padding:20px;
}
header{
    display:flex;flex-wrap:wrap;
    justify-content:space-between;
    align-items:center;gap:12px;
}
h2{margin:0;color:var(--primary);}
.btn{
    border:none;padding:10px 14px;
    border-radius:12px;
    cursor:pointer;font-weight:600;transition:.2s;
}
.btn:hover{transform:translateY(-2px)}
.add{background:var(--primary);color:#fff;}
.share{background:var(--success);color:#fff;}
.filter{background:#fff;border:1px solid #ddd;}
.edit{background:var(--warning);}
.delete{background:var(--danger);color:#fff;}

/* TABLE */
table{
    width:100%;
    border-collapse:collapse;
    margin-top:10px;
    border-radius:12px;
    overflow:hidden;
    box-shadow:0 10px 25px rgba(0,0,0,.1);
    background:#fff;
}
thead th{
    background:var(--dark);
    color:#fff;
    padding:14px;
    font-size:13px;
    text-align:left;
}
tbody td{
    padding:12px;
    border-bottom:1px solid #eee;
    font-size:14px;
}
tr:hover{background:#faf7ff;}
td.actions{white-space:nowrap;}
.badge{
    padding:5px 10px;
    border-radius:10px;
    font-size:12px;
    font-weight:600;
    display:inline-block;
}
.home{background:#ffe8cc}
.spot{background:#d0ebff;}

/* MODAL */
.modal{
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.6);
}
.modal-box{
    background:#fff;
    max-width:600px;
    margin:8% auto;
    padding:25px;
    border-radius:20px;
}
textarea{
    width:100%;
    height:200px;
    padding:14px;
    border-radius:12px;
    border:1px solid #ccc;
    resize:none;
}

/* RESPONSIVE */
@media(max-width:768px){
    table,thead,tbody,tr,th,td{display:block;width:100%}
    thead{display:none}
    tbody tr{margin-bottom:15px;border-radius:15px;padding:10px;box-shadow:0 5px 15px rgba(0,0,0,.08);}
    td{border:none;padding:6px 0;position:relative;}
    td::before{content:attr(data-label);font-weight:600;display:block;font-size:12px;color:#555;}
    td.actions{text-align:left;}
}
.footer{
    margin-top:40px;
    padding:15px 10px;
    text-align:center;
    font-size:13px;
    color:#555;
    background:rgba(255,255,255,.6);
    border-radius:14px;
    box-shadow:0 5px 15px rgba(0,0,0,.08);
}
.footer strong{
    color:#7b2cbf;
    font-weight:700;
}
</style>
</head>
<body>

<header>
<h2>ğŸ’„ Booking Eyelash List</h2><br>
<div>
    <button class="btn filter" onclick="setFilter('all')">ğŸ“‹ Semua</button>
    <button class="btn filter" onclick="setFilter('daily')">ğŸ“… Hari Ini</button>
    <button class="btn filter" onclick="setFilter('weekly')">ğŸ—“ï¸ Mingguan</button>
    <button class="btn add" onclick="openModal()">â• Input</button>
    <button class="btn share" onclick="share()">ğŸ“² Share Semua</button>
</div>
</header>

<!-- TABEL CONTAINER -->
<div id="tables-container"></div>

<!-- MODAL -->
<div class="modal" id="modal">
<div class="modal-box">
<h3 id="modalTitle">ğŸ“‹ Paste Booking</h3>
<textarea id="input" placeholder="Paste teks booking di sini..."></textarea><br><br>
<button class="btn add" onclick="save()">ğŸ’¾ Simpan</button>
<button class="btn filter" onclick="closeModal()">âŒ Batal</button>
</div>
</div>

<script>
let data=[], filter="all", editIndex=null;

// Load data dari localStorage
if(localStorage.getItem("bookingData")){
    data=JSON.parse(localStorage.getItem("bookingData"));
}

// MODAL
function openModal(edit=false){
    modal.style.display="block";
    if(!edit){input.value=""; editIndex=null; modalTitle.innerText="ğŸ“‹ Paste Booking";}
}
function closeModal(){modal.style.display="none";}

// PARSE DATA
function parse(block){
    const g=l=>(block.match(new RegExp(l+":(.*)"))||["",""])[1].trim();
    const t=g("Tanggal"), j=g("Jam");
    return{
        nama:g("Nama"),
        alamat:g("Alamat"),
        service:g("Service"),
        jenis:g("Jenis"),
        ukuran:g("Ukuran"),
        tanggal:t,
        jam:j,
        dp:g("DP"),
        datetime:new Date(t.replace(/.*,\s*/,"")+" "+j)
    };
}

// SIMPAN
function save(){
    if(editIndex!==null){
        data[editIndex]=parse(input.value);
    }else{
        input.value.trim().split(/\n\s*\n/).forEach(b=>data.push(parse(b)));
    }
    localStorage.setItem("bookingData",JSON.stringify(data));
    closeModal();
    render();
}

// FILTER
function setFilter(f){filter=f;render();}

// RENDER TABEL PER SERVICE
function render(){
    const container=document.getElementById("tables-container");
    container.innerHTML="";
    const now=new Date();

    // Filter & urut
    const filtered = data
        .map((d,i)=>({...d,_index:i}))
        .filter(d=>{
            if(filter==="daily") return d.datetime.toDateString()===now.toDateString();
            if(filter==="weekly"){
                const diff=(d.datetime-now)/86400000;
                return diff>=0 && diff<=7;
            }
            return true;
        })
        .sort((a,b)=>a.datetime-b.datetime);

    // Kelompok per service
    const services={};
    filtered.forEach(d=>{
        if(!services[d.service]) services[d.service]=[];
        services[d.service].push(d);
    });

    let totalAll=0;
    for(const s in services){
        const list=services[s];
        totalAll+=list.length;

        // JUMLAH DI ATAS TABEL
        container.innerHTML+=`<h3>ğŸ’„ ${s} (Jumlah: ${list.length})</h3>`;

        let html=`<table>
        <thead>
            <tr>
                <th>No</th>
                <th>ğŸ‘© Nama</th>
                <th>ğŸ“ Alamat</th>
                <th>ğŸ“† Tanggal</th>
                <th>â° Jam</th>
                <th>âœ¨ Jenis + Ukuran</th>
                <th>ğŸ’° DP/th>
                <th>âš™ï¸ Aksi</th>
            </tr>
        </thead>
        <tbody>`;
        list.forEach((d,i)=>{
            html+=`<tr>
                <td data-label="No">${i+1}</td>
                <td data-label="Nama">ğŸ‘© ${d.nama}</td>
                <td data-label="Alamat">ğŸ“ ${d.alamat}</td>
                <td data-label="Tanggal">ğŸ“† ${d.tanggal}</td>
                <td data-label="Jam">â° ${d.jam}</td>
                <td data-label="Jenis">âœ¨ ${d.jenis} (${d.ukuran})</td>
                <td data-label="Dp">ğŸ’° ${d.dp} </td>
                <td class="actions" data-label="Aksi">
                    <button class="btn edit" onclick="edit(${d._index})">âœï¸</button>
                    <button class="btn delete" onclick="hapus(${d._index})">ğŸ—‘ï¸</button>
                </td>
            </tr>`;
        });
        html+=`</tbody></table>`;
        container.innerHTML+=html;
    }

    // TOTAL SEMUA
    if(totalAll>0){
        container.innerHTML+=`<h3>Total Semua Booking: ${totalAll} âœ¨</h3>`;
    }
}

// EDIT
function edit(i){
    const d = data[i];
    input.value=
`Nama: ${d.nama}
Alamat: ${d.alamat}
Service: ${d.service}
Jenis: ${d.jenis}
Ukuran: ${d.ukuran}
Tanggal: ${d.tanggal}
Jam: ${d.jam}
DP: ${d.dp}`;
    editIndex=i;
    modalTitle.innerText="âœï¸ Edit Booking";
    openModal(true);
}

// HAPUS
function hapus(i){
    if(confirm("Yakin hapus booking ini?")){
        data.splice(i,1);
        localStorage.setItem("bookingData",JSON.stringify(data));
        render();
    }
}

// SHARE WA SEMUA
function share(){
    let t="ğŸ“Œ REKAP BOOKING EYELASH\n\n";
    [...data].sort((a,b)=>a.datetime-b.datetime).forEach(d=>{
        t+=
`ğŸ‘© Nama: ${d.nama}
ğŸ“ Alamat: ${d.alamat}
ğŸ’„ Service: ${d.service}
âœ¨ Jenis: ${d.jenis} (${d.ukuran})
ğŸ“† Tanggal: ${d.tanggal}
â° Jam: ${d.jam}
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
`;
    });
    window.open("https://wa.me/?text="+encodeURIComponent(t));
}

// INITIAL RENDER
render();
</script>
<footer class="footer">
    <span>âœ¨ Made with â¤ï¸ by <strong>MZ_Arifin</strong></span>
</footer>
</body>
</html>